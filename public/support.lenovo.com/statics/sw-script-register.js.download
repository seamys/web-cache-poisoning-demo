!function(){if("serviceWorker"in navigator){var r,e,t,n=navigator.serviceWorker,i={versionTagSymbol:"v",scriptQuerySymbol:"script",scriptStrategyQuerySymbol:"strategy",scriptVersionQuerySymbol:"version",scriptInvokeTimeQuerySymbol:"invokeTime",defaultScriptInvokeTime:"DOMContentLoaded",scriptRegisterStrategies:{UN_REGISTER:"unregister",REGISTER:"register",REGISTER_IGNORE_FAILURE:"registerIgnoreFailure",UPDATE:"update"}},o=e={mb:r=function(r){return function(e){return r.map((function(r){return e=(e||{})[r]}))&&e}},calcSwScriptURL:r(["active","scriptURL"]),updateQueryStringParam:function(r,e,t){if(!t)return r;var n=new RegExp("([?&])"+e+"=.*?(&|$)","i"),i=-1!==r.indexOf("?")?"&":"?";return n.test(r)?r.replace(n,"$1"+e+"="+t+"$2"):r+i+e+"="+t},removeQueryStringParam:function(r,e){return[].concat(e).map((function(e){if(e){var t=new RegExp("([?&])"+e+"=.*?(&|$)","i");t.test(r)&&(r=r.replace(t,(function(r,e,t){return e&&e.startsWith("?")?t.replace("&","?"):t})))}})),r},getQueryStringFormTargetSearch:function(r,e,t){if(!r||"string"!=typeof r)return null;var n=new RegExp("(?:[?|&]?)"+e+"=([^&]*)(?:&|$)",t?"i":void 0),i=r.match(n);return null!=i?decodeURIComponent(i[1]):null},getDefaultSiteVersion:function(){var r=document.querySelector('meta[itemprop="version"]');if(r)return r.content||void 0},formatUrl:function(r){var e=document.createElement("a");return e.href=r,{href:e.href,origin:e.origin,host:e.host,hostname:e.hostname,port:e.port,pathname:e.pathname,protocol:e.protocol,search:e.search,hash:e.hash,password:e.password,username:e.username}},findMatchedServiceWorkerIns:function(r){var t=e.formatUrl(r).pathname;return n.getRegistrations().then((function(r){return r.find((function(r){var n=e.formatUrl(e.calcSwScriptURL(r)).pathname;if(n)return t===n}))}))},unRegisterServiceWorker:function(r){return e.findMatchedServiceWorkerIns(r).then((function(e){return e?e.unregister().then((function(e){return e&&console.log("[SERVICE_WORKER] De-Registration success.",r),e})):e}))},registerServiceWorker:function(r,t){var c=r,a=(t=t||{}).scriptVersion||e.getDefaultSiteVersion();a&&(c=o.updateQueryStringParam(c,i.versionTagSymbol,a));var u=function(){return n.register(c).then((function(e){return console.log("[SERVICE_WORKER] Registration success.",r),e}))};return e.findMatchedServiceWorkerIns(r).then((function(r){if(!r)return u();if(t.forceUpdate)return r.unregister().then(u);var n=e.calcSwScriptURL(r),c=o.getQueryStringFormTargetSearch(n,i.versionTagSymbol);return c&&a&&a===c?void 0:r.unregister().then(u)}))}},c=((t={currentScriptUrl:o.mb(["currentScript","src"])(document)}).targetSwScriptUrl=decodeURIComponent(o.getQueryStringFormTargetSearch(t.currentScriptUrl,i.scriptQuerySymbol)||""),t.registerVersion=o.getQueryStringFormTargetSearch(t.currentScriptUrl,i.versionTagSymbol),t.targetSwScriptStrategy=o.getQueryStringFormTargetSearch(t.currentScriptUrl,i.scriptStrategyQuerySymbol),t.targetSwScriptVersion=o.getQueryStringFormTargetSearch(t.currentScriptUrl,i.scriptVersionQuerySymbol)||void 0,t.targetSwScriptInvokeTime=o.getQueryStringFormTargetSearch(t.currentScriptUrl,i.scriptInvokeTimeQuerySymbol)||i.defaultScriptInvokeTime,t);({_init:function(){var r=c.targetSwScriptUrl,e=c.targetSwScriptStrategy,t=c.targetSwScriptVersion,n=c.targetSwScriptInvokeTime,a=i.scriptRegisterStrategies;r&&window.addEventListener(n,(function(){return e===a.UN_REGISTER?o.unRegisterServiceWorker(r):o.registerServiceWorker(r,{scriptVersion:t||c.registerVersion,forceUpdate:e===a.UPDATE}).catch((function(t){if(console.error("[SERVICE_WORKER] Registration failed.",r,t),a.REGISTER_IGNORE_FAILURE!==e)return o.unRegisterServiceWorker(r)}))}))}})._init()}}();